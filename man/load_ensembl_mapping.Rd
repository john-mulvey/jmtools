% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ensembl.R
\name{load_ensembl_mapping}
\alias{load_ensembl_mapping}
\title{Load Ensembl BioMart gene annotations from local TSV}
\usage{
load_ensembl_mapping(
  species = "human",
  file = NULL,
  database_dir = "~/Documents/databases/ensembl_biomart"
)
}
\arguments{
\item{species}{Character string specifying the species. Must be one of
\code{"human"} or \code{"mouse"}. Default: \code{"human"}.}

\item{file}{Character string specifying a particular filename (not full
path) to load, e.g. \code{"ensembl_human_biomart_20260206.tsv"}. When \code{NULL}
(default), the most recently modified file matching the species is used.}

\item{database_dir}{Character string specifying the directory containing
the BioMart TSV files. Default: \code{"~/Documents/databases/ensembl_biomart"}.}
}
\value{
A tibble with the following columns:
\describe{
\item{ensembl_gene_id}{Ensembl gene stable ID (e.g., ENSG00000141510)}
\item{gene_name}{HGNC gene symbol (e.g., TP53)}
\item{description}{Gene description from Ensembl}
\item{uniprotswissprot}{UniProtKB/Swiss-Prot accession (e.g., P04637)}
\item{entrezgene_id}{NCBI Entrez gene ID (e.g., 7157)}
\item{gene_biotype}{Gene biotype (e.g., protein_coding, lncRNA)}
\item{chromosome_name}{Chromosome or scaffold name}
\item{uniprot_gn_symbol}{UniProtKB gene name symbol}
}
}
\description{
Reads a locally downloaded Ensembl BioMart TSV file and returns a tibble
with standardised column names. The file is expected to live at
\verb{~/Documents/databases/ensembl_biomart/} and follow the naming convention
\verb{ensembl_<species>_biomart_<date>.tsv}.
}
\details{
This function provides a stable alternative to the \code{biomaRt} R package,
which can be unreliable due to dependency conflicts and session management
issues. The underlying data are downloaded directly from the Ensembl
BioMart web service using curl (see the download script in the database
directory).

When \code{file} is not specified, the most recently modified file matching the
species is used and its filename is printed so the notebook output records
which version was loaded. To pin a specific version for reproducibility,
pass the filename via the \code{file} parameter.
}
\examples{
\dontrun{
# Load the latest human annotations
ensembl <- load_ensembl_mapping()

# Pin a specific version
ensembl <- load_ensembl_mapping(file = "ensembl_human_biomart_20260206.tsv")

# Load mouse annotations
ensembl_mouse <- load_ensembl_mapping("mouse")

# Filter to UniProt accessions in your dataset
ensembl \%>\%
  dplyr::filter(uniprotswissprot \%in\% my_protein_ids) \%>\%
  dplyr::select(uniprotswissprot, entrezgene_id, ensembl_gene_id) \%>\%
  dplyr::distinct()

# Map Ensembl IDs to gene names
ensembl \%>\%
  dplyr::filter(ensembl_gene_id \%in\% my_ensembl_ids) \%>\%
  dplyr::select(ensembl_gene_id, gene_name) \%>\%
  dplyr::distinct()
}
}
