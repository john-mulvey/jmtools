% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/boilerplate.R
\name{generate_limma_boilerplate}
\alias{generate_limma_boilerplate}
\title{Generate limma boilerplate code}
\usage{
generate_limma_boilerplate(
  data_name,
  metadata_name,
  id_col = "sample_id",
  formula = "~ 0 + group",
  contrast = "treatment - control",
  output_name = NULL,
  feature_id_col = "feature_id",
  fc_threshold = 1,
  adj_p_threshold = 0.05,
  include_anova = FALSE,
  include_effect_size = TRUE
)
}
\arguments{
\item{data_name}{Character string specifying the name of the expression/abundance
matrix variable (features as rows, samples as columns).}

\item{metadata_name}{Character string specifying the name of the metadata
data frame variable.}

\item{id_col}{Character string specifying the column in metadata containing
sample identifiers that match the column names of the data matrix.
Default: "sample_id".}

\item{formula}{Character string specifying the model formula for the design
matrix. Use \code{"~ 0 + group"} for a no-intercept model where coefficients
represent group means (recommended for contrasts). Use \code{"~ group"} for an
intercept model where coefficients represent differences from the reference
level. Default: \code{"~ 0 + group"}.}

\item{contrast}{Character string specifying the contrast to test. Should be
in the form \code{"groupA - groupB"} matching the column names in the design
matrix. For \code{~ 0 + group} formulas, use the factor levels directly
(e.g., \code{"treatment - control"}). For \code{~ group} formulas with intercept,
column names will be like \code{grouptreatment}. Default: \code{"treatment - control"}.
Set to \code{NULL} to skip pairwise contrast testing (only run ANOVA if
\code{include_anova = TRUE}).}

\item{output_name}{Character string specifying the name for the output
results object. If \code{NULL} (default), auto-generates from the contrast
(e.g., \code{"heart_failure - control"} becomes
\code{"limma_results_heart_failure_vs_control"}).}

\item{feature_id_col}{Character string specifying the name to use for the
feature identifier column in results. Default: \code{"feature_id"}.}

\item{fc_threshold}{Default fold-change threshold for the generated code.
Default: 1 (i.e., 2-fold change on linear scale).}

\item{adj_p_threshold}{Default adjusted p-value threshold for the generated
code. Default: 0.05.}

\item{include_anova}{Logical. If \code{TRUE}, includes code for an F-test
(ANOVA) testing for any differences between groups. Default: \code{FALSE}.}

\item{include_effect_size}{Logical. If \code{TRUE}, includes code to calculate
Cohen's d (standardised effect size) for pairwise contrasts. Uses the
moderated posterior SD from limma's empirical Bayes framework, which
already addresses small-sample variance instability (hence Hedge's g
correction is not applied). Default: \code{TRUE}.}
}
\value{
Returns \code{invisible(NULL)}. The function prints code to the console
which can be copied into an analysis script.
}
\description{
Outputs boilerplate R code for performing differential expression/abundance
analysis using limma. The generated code includes design matrix creation,
model fitting, contrast specification, and results extraction with
snake_case column names.
}
\details{
The generated code follows a standard limma workflow:

\enumerate{
\item Define significance thresholds (\code{fc_threshold}, \code{adj_p_threshold})
\item Create design matrix from the specified formula
\item Fit linear model with \code{limma::lmFit()}
\item Define and fit contrasts with \code{limma::makeContrasts()} and
\code{limma::contrasts.fit()}
\item Compute moderated statistics with \code{limma::eBayes()}
\item Extract results with \code{limma::topTable()}
\item Clean column names to snake_case using \code{janitor::clean_names()}
\item Add \code{diff_abundant} boolean column based on thresholds
}

If \code{include_anova = TRUE}, additional code is generated to perform an F-test
comparing all groups against a reference level (the first factor level).
This tests the null hypothesis that all group means are equal.

Column names in the output are converted to snake_case, with \code{adj.P.Val}
renamed to \code{adj_p_value} for consistency.
}
\examples{
# Generate boilerplate for basic analysis
generate_limma_boilerplate(
  data_name = "abundance",
  metadata_name = "sample_meta"
)

# Heart failure vs control example
generate_limma_boilerplate(
  data_name = "abundance",
  metadata_name = "sample_meta",
  formula = "~ 0 + group",
  contrast = "heart_failure - control"
)

# Include ANOVA F-test for overall group differences
generate_limma_boilerplate(
  data_name = "abundance",
  metadata_name = "sample_meta",
  formula = "~ 0 + treatment",
  contrast = "drug - placebo",
  include_anova = TRUE
)
}
