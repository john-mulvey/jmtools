% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/eda.R
\name{plot_pc_metadata_associations}
\alias{plot_pc_metadata_associations}
\title{Plot PC-metadata associations as a heatmap}
\usage{
plot_pc_metadata_associations(
  association_results,
  p_threshold = 0.05,
  use_adjusted_p = TRUE,
  show_all = FALSE,
  order_by_pc = 1,
  fill_limits = c(-1, 1),
  title = NULL
)
}
\arguments{
\item{association_results}{Data frame of results from
\code{\link[=test_pc_metadata_associations]{test_pc_metadata_associations()}}.}

\item{p_threshold}{Significance threshold for highlighting associations
(default: 0.05).}

\item{use_adjusted_p}{Logical. If \code{TRUE} (default), uses adjusted p-values
for determining significance. If \code{FALSE}, uses raw p-values.}

\item{show_all}{Logical. If \code{TRUE}, shows all tested associations. If
\code{FALSE} (default), shows only significant associations.}

\item{order_by_pc}{Integer specifying which PC to use for ordering variables
by effect size (default: 1 for PC1).}

\item{fill_limits}{Numeric vector of length 2 specifying the limits for the
colour scale (default: \code{c(-1, 1)}). Values outside this range are squished
to the nearest limit. For Spearman correlations, [-1, 1] is appropriate.
For eta-squared values (Kruskal-Wallis), consider \code{c(0, 1)} or a narrower
range based on observed values.}

\item{title}{Optional plot title. If \code{NULL}, no title is added.}
}
\value{
A ggplot2 object. Returns \code{NULL} with a warning if no associations
meet the criteria for plotting.
}
\description{
Creates a heatmap visualisation of associations between principal components
and metadata variables, with significant associations highlighted.
}
\details{
The heatmap uses a diverging colour scale from blue (negative association)
through white (no association) to red (positive association). Significant
associations are highlighted with bold black borders and bold text.

Effect sizes outside \code{fill_limits} are squished to the nearest limit.
The default [-1, 1] is appropriate for Spearman correlations. For
Kruskal-Wallis eta-squared values (which are always positive and typically
small), consider adjusting the limits or using \code{c(0, 1)}.
}
\examples{
\dontrun{
# First run association tests
associations <- test_pc_metadata_associations(
  pca_coords = pca_result[["ind"]]$coord,
  metadata = sample_metadata,
  vars_to_test = c("age", "sex", "treatment")
)

# Plot all associations
plot_pc_metadata_associations(associations, show_all = TRUE)

# Plot only significant associations
plot_pc_metadata_associations(associations, show_all = FALSE)

# Use raw p-values instead of adjusted
plot_pc_metadata_associations(associations, use_adjusted_p = FALSE)
}

}
\seealso{
\code{\link[=test_pc_metadata_associations]{test_pc_metadata_associations()}} for generating the input data
}
