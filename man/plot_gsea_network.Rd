% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gsea.R
\name{plot_gsea_network}
\alias{plot_gsea_network}
\title{Plot GSEA results as a network graph}
\usage{
plot_gsea_network(
  gsea_results,
  gene_set_col = "gene_set",
  nes_col = "nes",
  adj_pval_col = "adj_p_value",
  leading_edge_col = "leading_edge",
  n_genes_col = "n_genes",
  adj_p_threshold = 0.05,
  similarity_threshold = 0.3,
  min_cluster_size = 3,
  exclude_singletons = FALSE,
  show_labels = TRUE,
  label_clusters_by = c("pagerank", "n_genes"),
  layout = "fr",
  title = NULL,
  node_size_range = c(2, 8),
  concavity = 4,
  expand_hull = ggplot2::unit(3, "mm"),
  seed = 42
)
}
\arguments{
\item{gsea_results}{Data frame of GSEA results, typically from fgsea with
cleaned column names (e.g., output from \code{generate_gsea_boilerplate()}).}

\item{gene_set_col}{Character string specifying the column containing gene
set names. Default: "gene_set".}

\item{nes_col}{Character string specifying the column containing Normalised
Enrichment Scores. Default: "nes".}

\item{adj_pval_col}{Character string specifying the column containing
adjusted p-values for filtering. Default: "adj_p_value".}

\item{leading_edge_col}{Character string specifying the column containing
leading edge genes (as a list column). Default: "leading_edge".}

\item{n_genes_col}{Character string specifying the column containing the
number of genes in each gene set. Default: "n_genes".}

\item{adj_p_threshold}{Adjusted p-value threshold for filtering gene sets.
Default: 0.05.}

\item{similarity_threshold}{Minimum Jaccard similarity to draw an edge
between two gene sets. Default: 0.3.}

\item{min_cluster_size}{Minimum number of gene sets in a cluster to draw
a hull and label. Default: 3.}

\item{exclude_singletons}{Logical. If \code{TRUE}, singleton clusters (size 1)
are excluded from the plot. Default: \code{FALSE}.}

\item{show_labels}{Logical. If \code{TRUE}, shows cluster labels on the plot.
Default: \code{TRUE}.}

\item{label_clusters_by}{Method for selecting the representative label for
each cluster. One of "pagerank" (highest PageRank centrality) or
"n_genes" (largest gene set). Default: "pagerank".}

\item{layout}{Layout algorithm for the network. Default: "fr"
(Fruchterman-Reingold).}

\item{title}{Optional plot title. Default: \code{NULL}.}

\item{node_size_range}{Numeric vector of length 2 specifying the range of
node sizes. Default: \code{c(2, 8)}.}

\item{concavity}{Concavity parameter for hull shapes. Higher values create
more convex hulls. Default: 4.}

\item{expand_hull}{Amount to expand hulls around points. Default:

\code{ggplot2::unit(3, "mm")}.}

\item{seed}{Random seed for layout reproducibility. Default: 42.}
}
\value{
A ggplot2 object. Returns \code{NULL} with a warning if fewer than 2
gene sets meet the significance threshold.

\strong{Cluster assignments} are stored as an attribute and can be accessed via
\code{attr(plot, "clusters")}. This returns a data frame with columns:
\describe{
\item{gene_set}{Name of the gene set}
\item{cluster}{Integer cluster ID (from Walktrap algorithm)}
\item{nes}{Normalised Enrichment Score}
\item{cluster_label}{Representative name for clusters meeting
\code{min_cluster_size} (NA for smaller clusters)}
}
}
\description{
Creates a network visualisation of Gene Set Enrichment Analysis results,
where nodes are gene sets and edges represent similarity between their
leading edge genes. Clusters are detected and can be labelled directly
on the plot using convex hulls.
}
\details{
The network visualisation shows:
\itemize{
\item \strong{Nodes}: Gene sets, sized by number of genes, coloured by NES
\item \strong{Edges}: Connections between gene sets with Jaccard similarity
above the threshold, with edge width proportional to similarity
\item \strong{Clusters}: Detected using the Walktrap algorithm, shown as
coloured hulls with labels
}

Edge weights are calculated as the Jaccard similarity between the leading
edge genes of each pair of gene sets. This captures functional similarity
based on the genes driving the enrichment signal.

Cluster labels are determined by selecting the most "central" gene set
within each cluster, either by PageRank centrality or by gene set size.

\strong{Note:} Both this function and \code{\link[=cluster_enrichment_results]{cluster_enrichment_results()}} use the
Walktrap algorithm for clustering, so cluster assignments should be
consistent between the two (given the same similarity threshold).
}
\section{Required Packages}{

This function requires the following packages to be installed:
\itemize{
\item tidygraph
\item ggraph
\item ggforce (for \code{geom_mark_hull})
}
}

\examples{
\dontrun{
# Plot GSEA network with default settings
plot_gsea_network(gsea_results)

# Adjust similarity threshold and cluster size
plot_gsea_network(
  gsea_results,
  similarity_threshold = 0.2,
  min_cluster_size = 5
)

# Without cluster labels
plot_gsea_network(gsea_results, show_labels = FALSE)

# Access cluster assignments
p <- plot_gsea_network(gsea_results)
clusters <- attr(p, "clusters")
head(clusters)
}

}
\seealso{
\code{\link[=plot_gsea_dots]{plot_gsea_dots()}} for a simpler dot plot visualisation
}
