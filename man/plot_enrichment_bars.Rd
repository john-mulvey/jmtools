% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gsea.R
\name{plot_enrichment_bars}
\alias{plot_enrichment_bars}
\title{Plot clustered enrichment results as a bar plot}
\usage{
plot_enrichment_bars(
  clustered_results,
  score_col = "nes",
  n_top = 20,
  title = "Enrichment Results (Clustered)",
  x_label = "Enrichment Score",
  colours = c(Enriched = "firebrick", Depleted = "steelblue"),
  wrap_labels = 40,
  show_n = TRUE,
  point_size = 2,
  point_alpha = 0.6
)
}
\arguments{
\item{clustered_results}{Data frame from \code{\link[=cluster_enrichment_results]{cluster_enrichment_results()}},
containing gene sets with \code{cluster} and \code{cluster_label} columns.}

\item{score_col}{Character string specifying the column containing enrichment
scores. Default: \code{"nes"} for GSEA; use \code{"enrichment_score"} for ORA.}

\item{n_top}{Number of top clusters to show (split between enriched and
depleted). Default: 20.}

\item{title}{Optional plot title. Default: \code{"Enrichment Results (Clustered)"}.}

\item{x_label}{Label for the x-axis. Default: \code{"Enrichment Score"}.}

\item{colours}{Named vector of colours for enriched and depleted clusters.
Default: \code{c(Enriched = "firebrick", Depleted = "steelblue")}.}

\item{wrap_labels}{Number of characters at which to wrap long cluster labels.
Set to \code{NULL} to disable wrapping. Default: 40.}

\item{show_n}{Logical. If \code{TRUE}, appends the number of gene sets in each
cluster to the label. Default: \code{TRUE}.}

\item{point_size}{Size of the individual gene set points. Default: 2.}

\item{point_alpha}{Alpha transparency of individual points. Default: 0.6.}
}
\value{
A ggplot2 object.
}
\description{
Creates a bar plot of clustered enrichment results (GSEA or ORA) showing
mean enrichment score with individual gene set values overlaid as points.
}
\details{
The plot displays:
\itemize{
\item \strong{Bars}: Mean enrichment score for each cluster
\item \strong{Points}: Individual gene set score values, jittered vertically
\item \strong{Y-axis}: Cluster labels (representative gene set name)
\item \strong{Colour}: Direction of enrichment (Enriched or Depleted)
\item \strong{Facets}: Separate panels for Depleted and Enriched clusters
}

This function works with both GSEA and ORA results:
\itemize{
\item \strong{GSEA}: Use \code{score_col = "nes"}, \code{x_label = "Normalised Enrichment Score (NES)"}
\item \strong{ORA}: Use \code{score_col = "enrichment_score"}, \code{x_label = "Enrichment Score (log2 fold enrichment)"}
}
}
\examples{
\dontrun{
# GSEA workflow
clustered_gsea <- cluster_enrichment_results(gsea_results)
plot_enrichment_bars(clustered_gsea)

# ORA workflow
clustered_ora <- cluster_enrichment_results(
  ora_results,
  score_col = "enrichment_score",
  genes_col = "overlap_genes",
  n_genes_col = "n_gene_set"
)
plot_enrichment_bars(
  clustered_ora,
  score_col = "enrichment_score",
  x_label = "Enrichment Score (log2 fold enrichment)"
)
}

}
\seealso{
\code{\link[=cluster_enrichment_results]{cluster_enrichment_results()}} for clustering enrichment results,
\code{\link[=plot_gsea_dots]{plot_gsea_dots()}} for plotting unclustered GSEA results
}
